import{a as D}from"./chunk-YV6SONE4.js";import{b as N}from"./chunk-2BJLPANP.js";import{a as z}from"./chunk-5GVKMHBT.js";import{d as A}from"./chunk-S2XR63X6.js";import{c as T,d as R}from"./chunk-36TWDYNZ.js";import{$ as o,Aa as v,F as b,G as C,Ga as I,Hb as L,Ja as M,K as E,L as a,M as S,N as h,P as w,Ta as _,U as k,Ua as O,Va as B,X as y,Z as f,aa as u,ba as s,ga as P,ra as m,sa as p,za as g}from"./chunk-4YXWHVVD.js";import{i as l}from"./chunk-OYAVQN5W.js";var j=D("App",{web:()=>import("./chunk-UAZ4SFOI.js").then(r=>new r.AppWeb)});function q(r,c){r&1&&s(0,"i",22)}function U(r,c){r&1&&s(0,"i",23)}function F(r,c){r&1&&s(0,"div",24)}var le=(()=>{let c=class c{constructor(e,i,t,d,n,x,H){this.navCtrl=e,this.renderer2=i,this.zone=t,this.router=d,this.storageService=n,this.authService=x,this.requestsService=H,this.exitEmitter=new b,this.isListing=!1,this.previousElementId="",this.entryPoint="",this.currentElementId="home",this.isConnected=!1,this.freeForGuest=!1,this.lang="fr",this.navMap=[{id:"subscribe",down:"authentication",action:"navToPayment",type:"managed",route:"payment"},{id:"authentication",up:"subscribe",down:"home",action:"navToAuthentication",type:"managed",route:"authentication"},{id:"home",up:"authentication",down:"live",action:"navToHome",type:"managed",route:"home"},{id:"live",up:"home",down:"settings",action:"navToLive",type:"managed",route:"live-tv"},{id:"settings",up:"live",down:"language",action:"navToSettings",type:"managed",route:"settings"},{id:"language",up:"settings",down:"exit",action:"navToLanguage",type:"managed",route:"language"},{id:"exit",up:"language",action:"exitApp",type:"managed"}],this.backButtonPressed=!1,this.keydownTimeout=null,this.authService.authStatus.subscribe(G=>{this.isConnected=G}),this.initGlobalInfo()}ngOnInit(){return l(this,null,function*(){this.setupBackButtonHandler(),this.lang=yield this.storageService.get("lang")})}ngOnDestroy(){this.backButtonTimeout&&clearTimeout(this.backButtonTimeout)}setupBackButtonHandler(){window.handleBackButton=()=>{if(console.log("Back button pressed from Android - home page"),this.backButtonPressed){console.log("Back button already pressed, ignoring duplicate");return}this.backButtonPressed=!0,this.zone.run(()=>{this.handleKeyDown(new KeyboardEvent("keydown",{key:"Backspace"}))}),this.backButtonTimeout=setTimeout(()=>{this.backButtonPressed=!1},300)}}initGlobalInfo(){return l(this,null,function*(){this.freeForGuest=yield this.storageService.get("freeForGuest"),this.isConnected=yield this.authService.isLoggedIn()})}initSidebar(e,i){return l(this,null,function*(){this.isListing=!0,this.entryPoint=e,this.previousElementId=i,this.currentElement=this.findElementByRoute(this.router.url.substring(1)),this.currentElementId=this.currentElement.id,this.zone.run(()=>{this.setActive(this.currentElementId)})})}destroySidebar(){this.isListing=!1,this.previousElementId=this.currentElementId,this.setNotActive(this.currentElementId),this.entryPoint=""}navToHome(){this.zone.run(()=>{this.navCtrl.navigateBack("/home"),this.exitEmitter.emit(["ok","home"]),this.destroySidebar()})}navToMyListe(){this.zone.run(()=>{this.navCtrl.navigateBack("/my-liste"),this.exitEmitter.emit(["ok","my-liste"]),this.destroySidebar()})}navToLive(){this.zone.run(()=>{!this.isConnected&&!this.freeForGuest?(this.navCtrl.navigateBack("/authentication"),this.destroySidebar()):(this.navCtrl.navigateBack("/live-tv"),this.exitEmitter.emit(["ok","live-tv"]),this.destroySidebar())})}navToMyWatch(){this.zone.run(()=>{this.navCtrl.navigateBack("/my-watch"),this.exitEmitter.emit(["ok","my-watch"]),this.destroySidebar()})}navToSearch(){this.zone.run(()=>{this.navCtrl.navigateBack("/search"),this.exitEmitter.emit(["ok","search"]),this.destroySidebar()})}navToSettings(){this.zone.run(()=>{this.navCtrl.navigateBack("/settings"),this.destroySidebar()})}navToLanguage(){this.zone.run(()=>{this.navCtrl.navigateBack("/language"),this.exitEmitter.emit(["ok","language"]),this.destroySidebar()})}navToAuthentication(){this.zone.run(()=>{this.isConnected?this.logout():(this.navCtrl.navigateBack("/authentication"),this.destroySidebar())})}navToPayment(){this.zone.run(()=>{this.isConnected?(this.navCtrl.navigateBack("/payment"),this.destroySidebar()):(this.navCtrl.navigateBack("/authentication"),this.destroySidebar())})}logout(){return l(this,null,function*(){let e={uuid:yield this.storageService.get("myUUID")};this.requestsService.post("/users/LogoutGoogleTv",e).subscribe({next:i=>l(this,null,function*(){let t=JSON.parse(this.requestsService.decrypt(i.data));this.authService.logout(),this.router.navigate(["/home"])}),error:i=>{let t=JSON.parse(this.requestsService.decrypt(i.error.data))}})})}exitApp(){return l(this,null,function*(){yield this.storageService.set("displayed_animation",!1),j.exitApp()})}handleKeyDown(e){if(this.isListing)switch(e.key){case"ArrowUp":this.onUp();break;case"ArrowDown":this.onDown();break;case"ArrowLeft":this.lang==="ar"?this.onRight():this.onLeft();break;case"ArrowRight":this.lang==="ar"?this.onLeft():this.onRight();break;case"Enter":this.onOk();break;case"Backspace":case"backButton":case"Escape":this.onReturn();break;default:console.log(`[sidebar] Unhandled key: ${e.key}`)}}onUp(){this.zone.run(()=>{if(this.currentElement.up){let e=this.currentElement.up;if(document.getElementById(e)){let t=this.findElement(e);this.setActive(e),this.setNotActive(this.currentElementId),this.currentElement=t,this.currentElementId=e}}})}onDown(){this.zone.run(()=>{if(this.currentElement.down){let e=this.currentElement.down;if(document.getElementById(e)){let t=this.findElement(e);this.setNotActive(this.currentElementId),this.setActive(e),this.currentElement=t,this.currentElementId=e}}})}onLeft(){this.exitEmitter.emit(["left"])}onRight(){console.log("\u{1F680} ~ SidebarComponent ~ onRight ~ this.previousElementId:",this.previousElementId),this.exitEmitter.emit(["right",this.previousElementId])}onOk(){if(this.currentElement.action){let e=this.currentElement.action;this.zone.run(()=>{typeof this[e]=="function"&&this[e]()})}}onReturn(){}setActive(e){return l(this,null,function*(){let i=n=>new Promise(x=>setTimeout(x,n)),t=!1,d=0;do{yield i(200);let n=document.getElementById(e);n&&(this.renderer2.addClass(n,"active"),n.setAttribute("tabindex","0"),n.focus(),t=!0,this.incrementZIndex()),d++}while(!t&&d<20)})}setNotActive(e){return l(this,null,function*(){let i=n=>new Promise(x=>setTimeout(x,n)),t=!1,d=0;do{yield i(200);let n=document.getElementById(e);n?(this.renderer2.removeClass(n,"active"),n.setAttribute("tabindex","-1"),document.activeElement===n&&n.blur(),t=!0):d++}while(!t&&d<20)})}findElement(e){for(let i of this.navMap)if(i.id===e)return i;return this.navMap[0]}findElementByRoute(e){for(let i of this.navMap)if(i.route===e)return i;return this.navMap[0]}incrementZIndex(){let e=t=>{let d=window.getComputedStyle(t).zIndex;return((d==="auto"?0:parseInt(d,10))+1).toString()};document.querySelectorAll(".section").forEach(t=>{this.renderer2.setStyle(t,"z-index",e(t))})}};c.\u0275fac=function(i){return new(i||c)(h(L),h(S),h(C),h(_),h(A),h(z),h(N))},c.\u0275cmp=w({type:c,selectors:[["app-sidebar"]],hostBindings:function(i,t){i&1&&P("keydown",function(n){return t.handleKeyDown(n)},!1,E)},outputs:{exitEmitter:"exitEmitter"},decls:44,vars:34,consts:[["id","sidebar","tabindex","-1"],[1,"navs"],[1,"section"],["id","subscribe","tabindex","-1","routerLink","/payment","routerLinkActive","activeRoute",1,"nav"],[1,"ki-filled","ki-lock-2"],["id","authentication","tabindex","-1","routerLink","/authentication","routerLinkActive","activeRoute",1,"nav"],["class","ki-filled ki-entrance-left",4,"ngIf"],["class","ki-filled ki-entrance-right",4,"ngIf"],[1,"divider1"],[1,"section","middle-section"],["id","home","tabindex","-1","routerLink","/home","routerLinkActive","activeRoute",1,"nav"],[1,"ki-filled","ki-home"],["id","live","tabindex","-1","routerLinkActive","activeRoute",1,"nav"],[1,"ki-solid","ki-abstract-17"],[1,"divider2"],["id","settings","tabindex","-1","routerLink","/settings","routerLinkActive","activeRoute",1,"nav"],[1,"ki-filled","ki-setting-2"],["id","language","tabindex","-1","routerLink","/language","routerLinkActive","activeRoute",1,"nav"],[1,"ki-filled","ki-icon"],["id","exit","tabindex","-1",1,"nav"],[1,"ki-filled","ki-cross-circle"],["class","overlay",4,"ngIf"],[1,"ki-filled","ki-entrance-left"],[1,"ki-filled","ki-entrance-right"],[1,"overlay"]],template:function(i,t){i&1&&(o(0,"aside",0)(1,"div",1)(2,"div",2)(3,"div",3),s(4,"i",4),o(5,"p"),m(6),g(7,"translate"),u()(),o(8,"div",5),k(9,q,1,0,"i",6)(10,U,1,0,"i",7),o(11,"p"),m(12),g(13,"translate"),u()(),s(14,"div",8),u(),o(15,"div",9)(16,"div",10),s(17,"i",11),o(18,"p"),m(19),g(20,"translate"),u()(),o(21,"div",12),s(22,"i",13),o(23,"p"),m(24),g(25,"translate"),u()()(),o(26,"div",2),s(27,"div",14),o(28,"div",15),s(29,"i",16),o(30,"p"),m(31),g(32,"translate"),u()(),o(33,"div",17),s(34,"i",18),o(35,"p"),m(36),g(37,"translate"),u()(),o(38,"div",19),s(39,"i",20),o(40,"p"),m(41),g(42,"translate"),u()()()()(),k(43,F,1,0,"div",21)),i&2&&(f("open",t.isListing),a(2),f("hidden",!t.isListing),a(4),p(v(7,20,"Subscribe")),a(3),y("ngIf",!t.isConnected),a(),y("ngIf",t.isConnected),a(2),p(v(13,22,t.isConnected?"Log out":"Sign in")),a(4),f("active",t.isListing),a(3),p(v(20,24,"Home")),a(2),f("active",t.isListing),a(3),p(v(25,26,"Live Now")),a(2),f("hidden",!t.isListing),a(5),p(v(32,28,"Settings")),a(5),p(v(37,30,"Language")),a(5),p(v(42,32,"Exit")),a(2),y("ngIf",t.isListing))},dependencies:[M,I,O,B,R,T],styles:[".open[_ngcontent-%COMP%]{width:140px!important;background-color:#021024!important}html[dir=rtl][_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{right:0!important}html[dir=ltr][_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{left:0!important}aside[_ngcontent-%COMP%]{position:absolute;top:0;width:40px;height:100vh;z-index:99;display:flex;transition:ease-in-out .3s}aside[_ngcontent-%COMP%]   .navs[_ngcontent-%COMP%]{z-index:99;display:flex;flex-direction:column;gap:10px;width:100%;justify-content:space-between;outline:none;transition:ease-in-out .1s;padding:10px 0}aside[_ngcontent-%COMP%]   .navs[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]{z-index:99;padding:10px;outline:none;display:flex;align-items:center;gap:5px;transition:ease-in-out .1s;border-radius:20px 0 0 20px}aside[_ngcontent-%COMP%]   .navs[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px;z-index:99}aside[_ngcontent-%COMP%]   .navs[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;width:0;font-size:10px;transition:ease-in-out .1s;white-space:nowrap;z-index:99}aside[_ngcontent-%COMP%]   .navs[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]:focus{background-color:#243143;outline:none;color:#00d4ff;z-index:99}aside[_ngcontent-%COMP%]   .navs[_ngcontent-%COMP%]   .activeRoute[_ngcontent-%COMP%]{border-right:2px solid #00d4ff;outline:none}.open[_ngcontent-%COMP%]   .navs[_ngcontent-%COMP%]{padding-left:20px}.open[_ngcontent-%COMP%]   .activeRoute[_ngcontent-%COMP%]{border-right:none!important;outline:none}aside.open[_ngcontent-%COMP%]   .navs[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:1;width:auto}.section[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;z-index:99}.divider1[_ngcontent-%COMP%]{width:100px;height:1px;background-color:#143459;margin-top:10px;z-index:99}.divider2[_ngcontent-%COMP%]{width:100px;height:1px;background-color:#143459;margin-bottom:10px;z-index:99}.hidden[_ngcontent-%COMP%]{visibility:hidden}.none[_ngcontent-%COMP%]{display:none}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:linear-gradient(to right,rgba(0,0,0,.6),transparent);z-index:10;transition:opacity .1s ease-in-out}.activeRoute.active[_ngcontent-%COMP%]{background-color:#243143;outline:none;color:#00d4ff;z-index:99}"]});let r=c;return r})();export{le as a};
