import{a as C}from"./chunk-5GVKMHBT.js";import{a as u,b as w,d as T}from"./chunk-S2XR63X6.js";import{Ma as l,Na as R,a as b,c as p,p as d,r as E,u as h}from"./chunk-4YXWHVVD.js";import{g as x,i as U}from"./chunk-OYAVQN5W.js";var o=[];for(let t=0;t<256;++t)o.push((t+256).toString(16).slice(1));function I(t,e=0){return(o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]).toLowerCase()}var f,D=new Uint8Array(16);function y(){if(!f){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");f=crypto.getRandomValues.bind(crypto)}return f(D)}var H=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),g={randomUUID:H};function V(t,e,n){var i,a,s;if(g.randomUUID&&!e&&!t)return g.randomUUID();t=t||{};let r=(s=(a=t.random)!=null?a:(i=t.rng)==null?void 0:i.call(t))!=null?s:y();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){if(n=n||0,n<0||n+16>e.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let m=0;m<16;++m)e[n+m]=r[m];return e}return I(r)}var S=V;var v=x(w());var c=x(w());var G=(()=>{let e=class e{constructor(r,i,a){this.http=r,this.storageService=i,this.authService=a,this.secretKey=u.CRYPT_SECRET,this.baseUrl=u.CLIENT_SERVER_URI,this.sharedVariable=new b(!1),this.sharedVariable$=this.sharedVariable.asObservable()}createHeader(){return U(this,null,function*(){let r=yield this.authService.getToken(),i=S();return r?new l().set("Authorization","Bearer "+r).set("XSRF-TOKEN",i).set("X-XSRF-TOKEN",(0,v.MD5)(i+u.CSRF_SECRET).toString()):new l().set("XSRF-TOKEN",i).set("X-XSRF-TOKEN",(0,v.MD5)(i+u.CSRF_SECRET).toString())})}get(r){return p(this.createHeader()).pipe(d(i=>this.http.get(this.baseUrl+r,{headers:i})))}post(r,i){let a={data:this.encrypt(i)};return p(this.createHeader()).pipe(d(s=>this.http.post(this.baseUrl+r,a,{headers:s})))}patch(r,i){let a={data:this.encrypt(i)};return p(this.createHeader()).pipe(d(s=>this.http.patch(this.baseUrl+r,a,{headers:s})))}getFile(r){return p(this.createHeader()).pipe(d(i=>this.http.get(this.baseUrl+r,{headers:i,responseType:"blob"})))}delete(r){return p(this.createHeader()).pipe(d(i=>this.http.delete(this.baseUrl+r,{headers:i})))}encrypt(r){return c.AES.encrypt(JSON.stringify(r),this.secretKey.trim()).toString()}decrypt(r){return c.AES.decrypt(r,this.secretKey.trim()).toString(c.enc.Utf8)}};e.\u0275fac=function(i){return new(i||e)(h(R),h(T),h(C))},e.\u0275prov=E({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();export{S as a,G as b};
